---
source: macro/src/lib.rs
expression: "rustfmt_code(&gen_bridge(parse_quote! {\n                            mod ffi\n                            {\n                                struct Foo<'a>\n                                {\n                                    a: &'a [u8], b: &'a [u16], c: &'a str, d: &'a DiplomatStr,\n                                    e: &'a DiplomatStr16, f: &'a [DiplomatByte],\n                                } impl Foo\n                                {\n                                    pub fn\n                                    make(a: &'a [u8], b: &'a [u16], c: &'a str, d: &'a\n                                    DiplomatStr, e: &'a DiplomatStr16, f: &'a [DiplomatByte]) ->\n                                    Self { Foo { a, b, c, d, e, f, } } pub fn\n                                    boxes(a: Box<[u8]>, b: Box<[u16]>, c: Box<str>, d:\n                                    Box<DiplomatStr>, e: Box<DiplomatStr16>, f:\n                                    Box<[DiplomatByte]>) -> Self { unimplemented!() } pub fn\n                                    a(self) -> &[u8] { self.a } pub fn b(self) -> &[u16]\n                                    { self.b } pub fn c(self) -> &str { self.c } pub fn d(self)\n                                    -> &DiplomatStr { self.d } pub fn e(self) -> &DiplomatStr16\n                                    { self.e } pub fn f(self) -> &[DiplomatByte] { self.f }\n                                }\n                            }\n                        }).to_token_stream().to_string())"
---
mod ffi {
    #[repr(C)]
    #[derive(Clone, Copy)]
    struct Foo<'a> {
        a: &'a [u8],
        b: &'a [u16],
        c: &'a str,
        d: &'a DiplomatStr,
        e: &'a DiplomatStr16,
        f: &'a [DiplomatByte],
    }
    impl Foo {
        pub fn make(
            a: &'a [u8],
            b: &'a [u16],
            c: &'a str,
            d: &'a DiplomatStr,
            e: &'a DiplomatStr16,
            f: &'a [DiplomatByte],
        ) -> Self {
            Foo { a, b, c, d, e, f }
        }
        pub fn boxes(
            a: Box<[u8]>,
            b: Box<[u16]>,
            c: Box<str>,
            d: Box<DiplomatStr>,
            e: Box<DiplomatStr16>,
            f: Box<[DiplomatByte]>,
        ) -> Self {
            unimplemented!()
        }
        pub fn a(self) -> &[u8] {
            self.a
        }
        pub fn b(self) -> &[u16] {
            self.b
        }
        pub fn c(self) -> &str {
            self.c
        }
        pub fn d(self) -> &DiplomatStr {
            self.d
        }
        pub fn e(self) -> &DiplomatStr16 {
            self.e
        }
        pub fn f(self) -> &[DiplomatByte] {
            self.f
        }
    }
    use diplomat_runtime::*;
    #[no_mangle]
    extern "C" fn Foo_make(
        a_diplomat_data: *const u8,
        a_diplomat_len: usize,
        b_diplomat_data: *const u16,
        b_diplomat_len: usize,
        c_diplomat_data: *const u8,
        c_diplomat_len: usize,
        d_diplomat_data: *const u8,
        d_diplomat_len: usize,
        e_diplomat_data: *const u16,
        e_diplomat_len: usize,
        f_diplomat_data: *const DiplomatByte,
        f_diplomat_len: usize,
    ) -> Foo {
        Foo::make(
            if a_diplomat_len == 0 {
                &[]
            } else {
                unsafe { core::slice::from_raw_parts(a_diplomat_data, a_diplomat_len) }
            },
            if b_diplomat_len == 0 {
                &[]
            } else {
                unsafe { core::slice::from_raw_parts(b_diplomat_data, b_diplomat_len) }
            },
            if c_diplomat_len == 0 {
                Default::default()
            } else {
                unsafe {
                    core::str::from_utf8_unchecked(core::slice::from_raw_parts(
                        c_diplomat_data,
                        c_diplomat_len,
                    ))
                }
            },
            if d_diplomat_len == 0 {
                Default::default()
            } else {
                unsafe { core::slice::from_raw_parts(d_diplomat_data, d_diplomat_len) }
            },
            if e_diplomat_len == 0 {
                Default::default()
            } else {
                unsafe { core::slice::from_raw_parts(e_diplomat_data, e_diplomat_len) }
            },
            if f_diplomat_len == 0 {
                &[]
            } else {
                unsafe { core::slice::from_raw_parts(f_diplomat_data, f_diplomat_len) }
            },
        )
    }
    #[no_mangle]
    extern "C" fn Foo_boxes(
        a_diplomat_data: *mut u8,
        a_diplomat_len: usize,
        b_diplomat_data: *mut u16,
        b_diplomat_len: usize,
        c_diplomat_data: *mut u8,
        c_diplomat_len: usize,
        d_diplomat_data: *mut u8,
        d_diplomat_len: usize,
        e_diplomat_data: *mut u16,
        e_diplomat_len: usize,
        f_diplomat_data: *mut DiplomatByte,
        f_diplomat_len: usize,
    ) -> Foo {
        Foo::boxes(
            if a_diplomat_len == 0 {
                Default::default()
            } else {
                unsafe {
                    alloc::boxed::Box::from_raw(core::ptr::slice_from_raw_parts_mut(
                        a_diplomat_data,
                        a_diplomat_len,
                    ))
                }
            },
            if b_diplomat_len == 0 {
                Default::default()
            } else {
                unsafe {
                    alloc::boxed::Box::from_raw(core::ptr::slice_from_raw_parts_mut(
                        b_diplomat_data,
                        b_diplomat_len,
                    ))
                }
            },
            if c_diplomat_len == 0 {
                Default::default()
            } else {
                unsafe {
                    core::str::from_boxed_utf8_unchecked(alloc::boxed::Box::from_raw(
                        core::ptr::slice_from_raw_parts_mut(c_diplomat_data, c_diplomat_len),
                    ))
                }
            },
            if d_diplomat_len == 0 {
                Default::default()
            } else {
                unsafe {
                    alloc::boxed::Box::from_raw(core::ptr::slice_from_raw_parts_mut(
                        d_diplomat_data,
                        d_diplomat_len,
                    ))
                }
            },
            if e_diplomat_len == 0 {
                Default::default()
            } else {
                unsafe {
                    alloc::boxed::Box::from_raw(core::ptr::slice_from_raw_parts_mut(
                        e_diplomat_data,
                        e_diplomat_len,
                    ))
                }
            },
            if f_diplomat_len == 0 {
                Default::default()
            } else {
                unsafe {
                    alloc::boxed::Box::from_raw(core::ptr::slice_from_raw_parts_mut(
                        f_diplomat_data,
                        f_diplomat_len,
                    ))
                }
            },
        )
    }
    #[no_mangle]
    extern "C" fn Foo_a(this: Foo) -> &[u8] {
        this.a()
    }
    #[no_mangle]
    extern "C" fn Foo_b(this: Foo) -> &[u16] {
        this.b()
    }
    #[no_mangle]
    extern "C" fn Foo_c(this: Foo) -> &str {
        this.c()
    }
    #[no_mangle]
    extern "C" fn Foo_d(this: Foo) -> &DiplomatStr {
        this.d()
    }
    #[no_mangle]
    extern "C" fn Foo_e(this: Foo) -> &DiplomatStr16 {
        this.e()
    }
    #[no_mangle]
    extern "C" fn Foo_f(this: Foo) -> &[DiplomatByte] {
        this.f()
    }
}
